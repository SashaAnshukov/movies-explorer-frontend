{"ast":null,"code":"import _objectSpread from\"C:/dev/diploma/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"C:/dev/diploma/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/dev/diploma/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";export var MainApi=/*#__PURE__*/function(){function MainApi(options){_classCallCheck(this,MainApi);this._baseUrl=options.baseUrl;this._headers=options.headers;}_createClass(MainApi,[{key:\"_getResponseData\",value:function _getResponseData(response){return response.then(function(res,req){if(res.ok){return res.json();}if(res.status===409||res.status===404||res.status===400){return Promise.reject({status:res.status,text:res.statusText});}return Promise.reject(new Error(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u043E\\u043B\\u0443\\u0447\\u0435\\u043D\\u0438\\u044F \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445: \".concat(res.status,\" \").concat(res.statusText)));});}},{key:\"createMovie\",value:function createMovie(data){var token=localStorage.getItem(\"token\");return this._getResponseData(fetch(\"\".concat(this._baseUrl,\"/movies\"),{method:\"POST\",headers:_objectSpread(_objectSpread({},this._headers),{},{Authorization:\"Bearer \".concat(token)}),body:JSON.stringify({country:data.country,director:data.director,duration:data.duration,year:data.year,description:data.description,image:data.image,trailer:data.trailer,thumbnail:data.image,movieId:data.id,nameRU:data.nameRU,nameEN:data.nameEN})}));}}]);return MainApi;}();var mainApi=new MainApi({baseUrl:\"https://api.nomoreparties.co/beatfilm-movies\",headers:{\"Content-Type\":\"application/json\"}});export default mainApi;","map":{"version":3,"sources":["C:/dev/diploma/movies-explorer-frontend/src/utils/MainApi.js"],"names":["MainApi","options","_baseUrl","baseUrl","_headers","headers","response","then","res","req","ok","json","status","Promise","reject","text","statusText","Error","data","token","localStorage","getItem","_getResponseData","fetch","method","Authorization","body","JSON","stringify","country","director","duration","year","description","image","trailer","thumbnail","movieId","id","nameRU","nameEN","mainApi"],"mappings":"oXAAA,UAAaA,CAAAA,OAAb,yBACI,iBAAYC,OAAZ,CAAqB,+BACrB,KAAKC,QAAL,CAAgBD,OAAO,CAACE,OAAxB,CACA,KAAKC,QAAL,CAAgBH,OAAO,CAACI,OAAxB,CACH,CAJD,oDAMA,0BAAiBC,QAAjB,CAA2B,CACvB,MAAOA,CAAAA,QAAQ,CAACC,IAAT,CAAc,SAACC,GAAD,CAAMC,GAAN,CAAc,CAC/B,GAAID,GAAG,CAACE,EAAR,CAAY,CACZ,MAAOF,CAAAA,GAAG,CAACG,IAAJ,EAAP,CACC,CACD,GAAIH,GAAG,CAACI,MAAJ,GAAe,GAAf,EAAsBJ,GAAG,CAACI,MAAJ,GAAe,GAArC,EAA4CJ,GAAG,CAACI,MAAJ,GAAe,GAA/D,CAAoE,CAChE,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAe,CACtBF,MAAM,CAAEJ,GAAG,CAACI,MADU,CAEtBG,IAAI,CAAEP,GAAG,CAACQ,UAFY,CAAf,CAAP,CAIH,CACD,MAAOH,CAAAA,OAAO,CAACC,MAAR,CACH,GAAIG,CAAAA,KAAJ,6IAAsCT,GAAG,CAACI,MAA1C,aAAoDJ,GAAG,CAACQ,UAAxD,EADG,CAAP,CAGH,CAbM,CAAP,CAcC,CArBL,2BAuBA,qBAAYE,IAAZ,CAAkB,CACd,GAAMC,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACA,MAAO,MAAKC,gBAAL,CACHC,KAAK,WAAI,KAAKrB,QAAT,YAA4B,CACjCsB,MAAM,CAAE,MADyB,CAEjCnB,OAAO,gCACA,KAAKD,QADL,MAEHqB,aAAa,kBAAYN,KAAZ,CAFV,EAF0B,CAMjCO,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACjBC,OAAO,CAAEX,IAAI,CAACW,OADG,CAEjBC,QAAQ,CAAEZ,IAAI,CAACY,QAFE,CAGjBC,QAAQ,CAAEb,IAAI,CAACa,QAHE,CAIjBC,IAAI,CAAEd,IAAI,CAACc,IAJM,CAKjBC,WAAW,CAAEf,IAAI,CAACe,WALD,CAMjBC,KAAK,CAAEhB,IAAI,CAACgB,KANK,CAOjBC,OAAO,CAAEjB,IAAI,CAACiB,OAPG,CAQjBC,SAAS,CAAElB,IAAI,CAACgB,KARC,CASjBG,OAAO,CAAEnB,IAAI,CAACoB,EATG,CAUjBC,MAAM,CAAErB,IAAI,CAACqB,MAVI,CAWjBC,MAAM,CAAEtB,IAAI,CAACsB,MAXI,CAAf,CAN2B,CAA5B,CADF,CAAP,CAsBC,CA/CL,uBAkDA,GAAMC,CAAAA,OAAO,CAAG,GAAIzC,CAAAA,OAAJ,CAAY,CACxBG,OAAO,CAAE,8CADe,CAExBE,OAAO,CAAE,CACL,eAAgB,kBADX,CAFe,CAAZ,CAAhB,CAOA,cAAeoC,CAAAA,OAAf","sourcesContent":["export class MainApi {\r\n    constructor(options) {\r\n    this._baseUrl = options.baseUrl;\r\n    this._headers = options.headers;\r\n}\r\n\r\n_getResponseData(response) {\r\n    return response.then((res, req) => {\r\n        if (res.ok) {\r\n        return res.json();\r\n        }\r\n        if (res.status === 409 || res.status === 404 || res.status === 400) {\r\n            return Promise.reject({\r\n            status: res.status,\r\n            text: res.statusText,\r\n            });\r\n        }\r\n        return Promise.reject(\r\n            new Error(`Ошибка получения данных: ${res.status} ${res.statusText}`)\r\n        );\r\n    });\r\n    }\r\n\r\ncreateMovie(data) {\r\n    const token = localStorage.getItem(\"token\");\r\n    return this._getResponseData(\r\n        fetch(`${this._baseUrl}/movies`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            ...this._headers,\r\n            Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n            country: data.country,\r\n            director: data.director,\r\n            duration: data.duration,\r\n            year: data.year,\r\n            description: data.description,\r\n            image: data.image,\r\n            trailer: data.trailer,\r\n            thumbnail: data.image,\r\n            movieId: data.id,\r\n            nameRU: data.nameRU,\r\n            nameEN: data.nameEN,\r\n        }),\r\n        })\r\n    );\r\n    }\r\n}\r\n\r\nconst mainApi = new MainApi({\r\n    baseUrl: \"https://api.nomoreparties.co/beatfilm-movies\",\r\n    headers: {\r\n        \"Content-Type\": \"application/json\",\r\n    },\r\n});\r\n\r\nexport default mainApi;"]},"metadata":{},"sourceType":"module"}